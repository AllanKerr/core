language: node_js
node_js: node
addons:
  chrome: stable
script:
- npm run build
- npm run lint
- npm run test:sass
- |
  if [ $TRAVIS_PULL_REQUEST != false ] && [ $TRAVIS_SECURE_ENV_VARS == true ]; then
    npm run test:diff || travis_terminate 1;
    echo "Pull request with secure environment variables, running Sauce tests...";
    npm run test:sauce || travis_terminate 1;
  else
    echo "Not a pull request and/or no secure environment variables, running headless tests...";
    npm run test:travis || travis_terminate 1;
  fi
after_success:
- frauci-update-version -d=skip && export TRAVIS_TAG=$(frauci-get-version)
env:
  global:
  - REPO_NAME=core
  - OWNER_NAME=BrightspaceUI
  - SAUCE_USERNAME: Gaudi1
  # SAUCE_ACCESS_KEY
  - secure: bwPUP8HCJ4x/VQHYT83fw28MF6fZqcCFYYLQIuYl5d8QXPuHNiON+36YSEkIix/2AjuQR8OtNqy7MPem013QUzEl9ayJ+P/Kto3hN84D6fNj4DXKUtDywDeAs6B0hv3OZZIUJ2ixqClyGDRoK9M51NzS3d9Nts8rEDTJY5CqnD7s+0mOUXfmr7ehStQfs4JdsGApdp5ByA7btC6t3vNAUSoGOlnfKGb4VP/cCXAS64Suy/8Q09fCCKr2BMswQwR6hwb52EJ50W9JbpXu/S0DwrwwM5ZGCG4+SSXqrMoaWXeoOjjQ+tdTx+Rj/cvYO0IE9vJvEMubFCzjs57d2r9IwoKmJg27Fh7YPlZk4YEhcge2vDO9AmlGKGDKeEYco4fXelAmmCcFjmrWXjH8Uc31n2wZj4yYg6AKU2M+GvMYNmh+aI1qGJ+urpQigYdf8IWpqryW19wiOzRm+N6JhdFGlfgnJMEv/OmdTwGOXKA1Qlmc0Bv8ZjWHa6bVMrwnueygoUwc7rWYQg0SjIaW8zhTWwy2JkBoCD1/TpKYTNOdL4VSaxpRSCQn4uAlJ2rNBIyv7FM0S7ycKMTVQGXIyaRo28vKUEGUDYGYWbu++5fBxRfaHWeE79ZFE823LyFQetTUmr7ms/i4pqkaM/m+q840s34lLwmupSoUoVBAGezVsk8=
  # S3ID
  - secure: i+dWesW9OieFMI8DnJiHEMfa/PFa8DXutNgYMCDqArCwbuc4luWJW+zqJxszebPj7H09uG66iUVYxb9AmCv7HMN8wvzj1AUrweT/1Ia7SKXggsdki08u10TRy6bvp9N9rWCiRwbEmCJx/9XnzRu6wRBr7jOD0pSlW5Z54YlyrZV+E3G3DYDIdXc7XXngRN1ZsuLong88B94P91wl5sZyXgcgpagfQsmA0sGiFEPKemb6hSVq/8W0sEaCEMQWkSQey1arBdgqlt6q9z8gBYP7ka6UNHJ/amA+YoFOnXn/sDOtGNkaIWrCh3pg4AUlScEDv4lxd8lKQywb285VIE1yX5v8+hxzrWj9tDeVJBhEGAgUwNlv7PRXWtMLSCqBXpHThPYN2To6bpAFXW/y+qTI3o74l7WRVny0jBRcivPapc/pofyZEYvBGiG1Sr1zN/z94nnwD4mkiQYZ60kLQgxd5cSjmkzN1aAdzxXOQHMCpYkq1Z63mMzu/h45Bqq8lBjOdAS6v7DeWHm5QkyKKfFlk8kA8aM2Gvc7MJmMloOboUN+t7oiqU4Dwjf5OejpbGdOlvZCHBCh91NwM2k+jGIUhF4B1VIPKYtgl/213pzIg1VReHVy4M1JmNIuNQT+VGcfgvcxjPnJ+g6fVKlbfd0wRLNw6bM1Od3ELWDitUtrLBY=
  # S3KEY
  - secure: kLlBYte0VCpMMlzmWCQDvTONEcXgFJwudUNClYa990KBcCBB6IteFIqiUSvqvdtK7ql/AO6Jbbxk542P7W2KYHu251aqjQiWyu7bz3Geptsq8E8DAuYQWz2WLhD4Ic8CbaJG570QixQpjBtvQIDJu+H4M2buPDCluEdrAWWBBDEB6omtT4vwjSSxKB3XIjnS+LZg71VBQgEl9dsRiaieOSfHYNT8a1Nm1dcu9K/6hgPf+dV8AABhgL2QEhfxvgrbWJwbML+0TNs5syA3qpZL6kybeXJsxAAbotA0IYPiqstl7C6H8dfPBUVytTq5JStzp9ohNJgcW3SPRt43Kd21vptV+wMOAnpZ0gxZw50yCINtlFB5MaIGIYgQpHah9y7qsaZibVL+2NWD06A3RaoAnVD/8JAD1MzpceZP42D1/gR/QHuqVcQlRoQ5iBVoV0Ir/e887OJ5fRItAGuL0tM/cA7Ktf/RM84/lx5rP/XnSr18f7hvefMhvCqUpqbaj+xGh4wVkSi5S97BATnUC4o4JmIK7JdZCbP86t3etbblLhc7W8Mx4a8PmYIQ9JxhY0JCtalCBWJdyaoLtLDaFs/fsw4/0jgpLzdDDGebYdp8yc5DWt7Iek91NxX739j/1O12P6JqJsUresKgFf5zCtF3cvy5i+4ejLhawwHDjWedsZ4=
  # GITHUB_RELEASE_TOKEN (2374......46ed)
  - secure: Q0Nl6PYZhAvS2rUprp7yxAnFmaaWlRJ7Vek1y8uQ0h2Rm4hraRDTwmcFSKOdOgHnI75Wzn5qCcTDHnQMVu1tHUf7/Z1Fnk/2cG5Y5G/R877jihoaaSNdhlbBPV92EZ5+tSc51H3hmChoK4FePKv45KQLsz59txOYmsVzKd8ryKTXzrDSH5IA3ssyBLfRTT6RbRDdTRBOpoTR4zPBkWCj9vB1Pd4g01jZPk2oP1bd8sIfJp1vrEzRCOrR7FiuDIBNArKTqOoLt3rlNry4uZpwrZmmA5b0L7xNM1C1PUxMjCKZV7mT5MthVx9R2NVOrddxAE0P7z/6PK1V86oJYwoSySOedLM4AYCwddpZNzqIR5aEAM33rvbRYuyCURt/1w59SXb5zftigdjbVg7wbvxb7sxWOEbhg+LHlno0+8U1r2WU1OY3BZBvsEKCV4jGGJpSyhvQpJ0gyWfsNk3Kt37OFgG0ZBNdXgIfQ+jSzan8puoR8wUbz4DyuYOV/z5Y4LdswFR3q4/eo1FjjzBBz+fXDodXxUm2XT/lxz5uL23y5EUqfT6vIBXd2XhlQ/izS0PCckzPILSz+nOL/I4Hq/q2Zfzu+9kD/sL6G3n1c28LbQnNOsuXyfoBozVZvwPc8wXWf4jIJlWGUXCoyG2zRJkN5D64GnSDvzu6+TThOYU8ZNQ=
deploy:
- provider: npm
  email: d2ltravisdeploy@d2l.com
  skip_cleanup: true
  api_key:
      # 4e36......0778
    secure: asQJ4woXHKOy7aUD9DajzDTkGHQSTfbXLW4AP72Y3TeM8xOL/nSG55AsmcunKUn4SFsJgUehODv8hbQ5cjYxpV28p6O2ec1K69MH/bWsbhv6xPNraDdJG2oYc0CmRZl7gUZPUXsfO2pj1XjWXJgkWO/krWg8dDlg+AjAPwZCnFwpOL8HXOS44RT0Mo1Zgc6uE2Iq2tuj+8WTjLSF+aFcjWB9aNaDFhMK2bDLo/rqJtaK1yyphfpSDl/RD40o9SiGmV8Lt5N0ho1vtN/nmgLWo5FAm0zrDT5lbjC+dl9uKj9Y6hf9SBPARTyoN8D1ATpWaNxnGqtWNoLpNI/7+yygS5VOLfS6xvUxDIkcXt0F6ow7MWfxrIgeOQg8i9ZT+OKvMqMdwi0/f8XLkfvY43x0bmr+wN9/vKb5Xx7FWJxXIuLAHGSXmXZ4WMKxPmfhtbcfkCupN/HxCbdgD8Xaoaol5DpUZMYM2skGfRjq3p+GqZdSBMrubVudjCG9qDsLE0PQWxyB7Fi4+pVTRpzn3axGXRMF1kvtUD6X1en/6CubZan7JgjgMDj7CkgY0aubaCa8rDbaYaUvwH+Qkwb8bsNYgUQ5uEEifXAovKZYBthdlLervP6YeoV6x4dyBu7m0dB8pYCI1rZH941cg6oXz03bjP2nYu7TwYgsV8ofDgsdfZw=
  on:
    repo: BrightspaceUI/core
    tags: true
